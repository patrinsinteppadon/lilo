{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/Users/paola/Documents/Capstone/lilo/Calling.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Text from \"react-native-web/dist/exports/Text\";\n\nvar Calling = function (_React$Component) {\n  _inherits(Calling, _React$Component);\n\n  var _super = _createSuper(Calling);\n\n  function Calling(props) {\n    var _this;\n\n    _classCallCheck(this, Calling);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      startButton: false,\n      callButton: true,\n      hangupButton: true,\n      stopButton: true,\n      localStream: null,\n      pc1: null,\n      pc2: null,\n      localVideoSource: null\n    };\n    _this.startLocalVideo = _this.startLocalVideo.bind(_assertThisInitialized(_this));\n    _this.connectRemoteVideo = _this.connectRemoteVideo.bind(_assertThisInitialized(_this));\n    _this.stopRemoteVideo = _this.stopRemoteVideo.bind(_assertThisInitialized(_this));\n    _this.stopLocalVideo = _this.stopLocalVideo.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Calling, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(View, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 36,\n          columnNumber: 13\n        }\n      }, React.createElement(View, {\n        class: \"vide-screens\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 37,\n          columnNumber: 17\n        }\n      }), React.createElement(View, {\n        class: \"buttons\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 17\n        }\n      }, React.createElement(Button, {\n        title: \"start\",\n        disabled: this.state.startButton,\n        onPress: this.startLocalVideo,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 21\n        }\n      }), React.createElement(Button, {\n        title: \"call\",\n        disabled: this.state.callButton,\n        onPress: this.connectRemoteVideo,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 21\n        }\n      }), React.createElement(Button, {\n        title: \"hang up\",\n        disabled: this.state.hangupButton,\n        onPress: this.stopRemoteVideo,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 21\n        }\n      }), React.createElement(Button, {\n        title: \"stop\",\n        disabled: this.state.stopButton,\n        onPress: this.stopLocalVideo,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 21\n        }\n      })));\n    }\n  }, {\n    key: \"startLocalVideo\",\n    value: function startLocalVideo() {\n      var stream;\n      return _regeneratorRuntime.async(function startLocalVideo$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              this.setState({\n                startButton: true,\n                callButton: false,\n                stopButton: false\n              });\n              console.log(\"start local video\");\n              _context.prev = 2;\n              console.log(\"successfully started video\");\n              _context.next = 6;\n              return _regeneratorRuntime.awrap(navigator.mediaDevices.getUserMedia({\n                audio: true,\n                video: true\n              }));\n\n            case 6:\n              stream = _context.sent;\n              localVideoSource = stream;\n              localStream = stream;\n              _context.next = 14;\n              break;\n\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](2);\n              console.log('error in start local video');\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, this, [[2, 11]], Promise);\n    }\n  }, {\n    key: \"connectRemoteVideo\",\n    value: function connectRemoteVideo() {\n      this.setState({\n        callButton: true,\n        hangupButton: false\n      });\n      console.log(\"connect to remote video\");\n      var videoTracks = localStream.getVideoTracks();\n      var audioTracks = localStream.getAudioTracks();\n      var configuration = {};\n      pc1 = new RTCPeerConnection(configuration);\n    }\n  }, {\n    key: \"stopRemoteVideo\",\n    value: function stopRemoteVideo() {\n      this.setState({\n        startButton: false,\n        callButton: false,\n        hangupButton: true,\n        stopButton: true\n      });\n      console.log(\"stop remote video\");\n    }\n  }, {\n    key: \"stopLocalVideo\",\n    value: function stopLocalVideo() {\n      this.setState({\n        startButton: false,\n        stopButton: true\n      });\n      console.log(\"stop local video\");\n    }\n  }]);\n\n  return Calling;\n}(React.Component);\n\nexport default Calling;","map":{"version":3,"sources":["/Users/paola/Documents/Capstone/lilo/Calling.js"],"names":["React","Calling","props","state","startButton","callButton","hangupButton","stopButton","localStream","pc1","pc2","localVideoSource","startLocalVideo","bind","connectRemoteVideo","stopRemoteVideo","stopLocalVideo","setState","console","log","navigator","mediaDevices","getUserMedia","audio","video","stream","videoTracks","getVideoTracks","audioTracks","getAudioTracks","configuration","RTCPeerConnection","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { StyleSheet, View, Button, Text } from 'react-native';\n// import Video from 'react-native-video';\n// import {\n//     RTCPeerConnection,\n//     RTCIceCandidate,\n//     RTCSessionDescription,\n//     RTCView,\n//     MediaStream,\n//     MediaStreamTrack,\n//     mediaDevices,\n//     registerGlobals,\n//   } from 'react-native-webrtc';\n\nclass Calling extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            startButton:false,\n            callButton:true,\n            hangupButton:true,\n            stopButton:true,\n            localStream:null,\n            pc1:null,\n            pc2:null,\n            localVideoSource:null,\n        }\n        this.startLocalVideo = this.startLocalVideo.bind(this)\n        this.connectRemoteVideo = this.connectRemoteVideo.bind(this)\n        this.stopRemoteVideo = this.stopRemoteVideo.bind(this)\n        this.stopLocalVideo = this.stopLocalVideo.bind(this)\n    }\n\n    render() {\n        return (\n            <View>\n                <View class=\"vide-screens\">\n                    {/* <Video source={localVideoSource} \n                            ref={(ref) => {\n                                this.player = ref\n                            }}\n                            onBuffer={this.onBuffer}\n                            onError={this.videoError} /> */}\n                </View>\n\n                <View class=\"buttons\">\n                    {/* add start button: starts local video */}\n                    <Button title=\"start\" disabled={this.state.startButton} onPress={this.startLocalVideo} />\n\n                    {/* add call button: calls remote video  */}\n                    <Button title=\"call\" disabled={this.state.callButton} onPress={this.connectRemoteVideo} />\n\n                    {/* add hang-up button: stops remote video  */}\n                    <Button title=\"hang up\" disabled={this.state.hangupButton} onPress={this.stopRemoteVideo} />\n\n                    {/* add stop: stops local video */}\n                    <Button title=\"stop\" disabled={this.state.stopButton} onPress={this.stopLocalVideo} />\n                </View>\n            </View>\n        );\n\n    }\n\n    async startLocalVideo() {\n        // enable call and stop (local video) buttons\n        // disable start button\n        this.setState({startButton:true, callButton:false, stopButton:false})\n        console.log(\"start local video\")\n\n        try {\n            console.log(\"successfully started video\")\n            const stream = await navigator.mediaDevices.getUserMedia({audio:true, video:true})\n            localVideoSource = stream\n            localStream = stream\n        } catch (e) {\n            console.log('error in start local video')\n        }\n    }\n\n    connectRemoteVideo() {\n        // enable hangup button\n        // disable call button\n        this.setState({callButton:true, hangupButton:false})\n        console.log(\"connect to remote video\")\n\n        // DOESN'T WORK I THINK\n        // startTime = window.performance.now()\n        const videoTracks = localStream.getVideoTracks();\n        const audioTracks = localStream.getAudioTracks();\n        // if (videoTracks.length > 0) {\n        //     console.log('using video devide: ${videoTracks[0].label}')\n        // }\n        // if (audioTracks.length > 0) {\n        //     console.log('using audio devide: ${audioTracks[0].label}')\n        // }\n        const configuration = {}\n        pc1 = new RTCPeerConnection(configuration)\n\n        // THIS IS FROM TUTOTIAL ----------------->\n        // startTime = window.performance.now();\n        // const videoTracks = localStream.getVideoTracks();\n        // const audioTracks = localStream.getAudioTracks();\n        // if (videoTracks.length > 0) {\n        //   console.log(`Using video device: ${videoTracks[0].label}`);\n        // }\n        // if (audioTracks.length > 0) {\n        //   console.log(`Using audio device: ${audioTracks[0].label}`);\n        // }\n        // const configuration = {};\n        // console.log('RTCPeerConnection configuration:', configuration);\n        // pc1 = new RTCPeerConnection(configuration);\n        // console.log('Created local peer connection object pc1');\n        // pc1.addEventListener('icecandidate', e => onIceCandidate(pc1, e));\n        // pc2 = new RTCPeerConnection(configuration);\n        // console.log('Created remote peer connection object pc2');\n        // pc2.addEventListener('icecandidate', e => onIceCandidate(pc2, e));\n        // pc1.addEventListener('iceconnectionstatechange', e => onIceStateChange(pc1, e));\n        // pc2.addEventListener('iceconnectionstatechange', e => onIceStateChange(pc2, e));\n        // pc2.addEventListener('track', gotRemoteStream);\n      \n        // localStream.getTracks().forEach(track => pc1.addTrack(track, localStream));\n        // console.log('Added local stream to pc1');\n      \n        // try {\n        //   console.log('pc1 createOffer start');\n        //   const offer = await pc1.createOffer(offerOptions);\n        //   await onCreateOfferSuccess(offer);\n        // } catch (e) {\n        //   onCreateSessionDescriptionError(e);\n        // }\n        // <----------------- END OF TUTORIAL \n    }\n\n    stopRemoteVideo() {\n        // enable call button and start button\n        // disable hangup button and stop button\n        this.setState({startButton:false, callButton:false, hangupButton:true, stopButton:true})\n        console.log(\"stop remote video\")\n    }\n\n    stopLocalVideo() {\n        // enable start button \n        // disable stop button\n        this.setState({startButton:false, stopButton:true})\n        console.log(\"stop local video\")\n    }\n\n}\n\nexport default Calling;"]},"metadata":{},"sourceType":"module"}